Please refactor this Python code to improve readability, reduce cyclomatic complexity, and improve maintainability: