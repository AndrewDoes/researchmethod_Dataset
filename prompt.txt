Please refactor this full Python code to improve readability, reduce cyclomatic complexity, and improve maintainability: